<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Generic OSAL Implementations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F´ Flight Software - C/C++ Documentation
   &#160;<span id="projectnumber">devel</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__os__generic_docs_sdd.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Generic OSAL Implementations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This package provides generic implementations of various OSAL modules. These are implemented using generic data structures, other OSAL types, and C++ code. These specifically avoid calls down into any underlying operating system.</p>
<p>Available implementations:</p><ol type="1">
<li><a href="#ospriorityqueue">Os::PriorityQueue</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md541"></a>
Os::PriorityQueue</h1>
<p>Os::PriorityQueue is an in-memory implementation of <a class="el" href="class_os_1_1_queue.html">Os::Queue</a>. It allows projects that desire in-memory queue support to use Os::Queues. Os::PriorityQueue allocates memory for its underlying data structures using <code>new (nothrow)</code> and deallocates memory with <code>delete</code>. These actions are taken during <code>create</code> and object destruction. This implies that Os::PriorityQueue should be instantiated and initialized during system initialization.</p>
<p>For memory protection, Os::PriorityQueue delegates to <a class="el" href="class_os_1_1_mutex.html">Os::Mutex</a> and <a class="el" href="class_os_1_1_condition_variable.html" title="condition variable implementation">Os::ConditionVariable</a>.</p>
<h2><a class="anchor" id="autotoc_md542"></a>
Os::PriorityQueue Key Algorithms</h2>
<p>Os::PriorityQueue stores messages in a set of dynamically allocated unordered parallel arrays. These arrays store: message data, and message data size respectively. There is also an index-free list that stores the indices that are available for storage in the fixed size arrays.</p>
<p>In order to prioritize messages, a <a href="#typesmaxheap-data-structure">Types::MaxHeap</a> data structure is used.</p>
<p>When a message is received from a calling sender, <code>find_index</code> returns a free index from the free list. The data is copied into the message data array, and the size into the size array using this free index via <code>store_data</code>. The index is then inserted into the max heap structure for prioritization. When the queue is full and the <code>BLOCKING</code> option was supplied, the sender will block on the <code>m_full</code> condition variable until notified of a dequeue.</p>
<p>When a message is dequeued, the highest priority index is removed from the max heap. The data is copied out from the data array, and the size from the size array using that index via <code>load_data</code> and sent to the calling receiver. The index is then returned to the free list via <code>return_index</code> to indicate that it may be reused. When the queue is empty and the <code>BLOCKING</code> option was supplied, the receiver will block on the <code>m_empty</code> condition variable until notified of a enqueue.</p>
<p>If the queue is empty and data was received, the <code>m_empty</code> condition variable is notified to unblock waiting receivers. If the queue is full and data was dequeued, the <code>m_full</code> condition variable is notified to unblock waiting receivers.</p>
<h2><a class="anchor" id="autotoc_md543"></a>
Types::MaxHeap Data Structure</h2>
<p>The <a class="el" href="class_types_1_1_max_heap.html" title="A stable max heap data structure.">Types::MaxHeap</a> data structure is used to prioritize a list of indices using the given priority. This heap uses a dynamically allocated maximum-length array to back a binary tree storage structure. The first element is the root of the tree, left children are calculated using <code>2x + 1</code> and right children using <code>2x + 2</code>. A node's parent is at <code>(x - 1)/2</code>.</p>
<p>When an index is pushed into this structure, it starts at the first unused element (first free child of some node) and iteratively swaps with its parent as long as the new nodes priority is larger than the parent. This ensures that the higher-priority elements are closer to the root of the tree. Specifically, the root <em>is</em> the highest priority element.</p>
<p>When an index is pulled from this structure, the root is removed as it is the highest priority data structure. The last leaf of the tree is elevated to the root and <code>heapify</code> is then called to restore the max-heap invariant of the data structure.</p>
<p><code>heapify</code> starts at the newly ill-ordered root. It iteratively swaps this node with the highest-priority child until this node is the largest of the three (parent, left child, and right child) or until this node is swapped into a leaf position without children. The max-heap invariant is now restored. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
